!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.DCAgent={})}(this,function(t){"use strict";function e(){}function n(t){return"function"==typeof t}function r(t){return t&&"[object Object]"===ze.call(t)}function o(t){console.log("---- DCAgent log start ----\n"+t+"\n---- DCAgent log end   ----")}function i(t){var e,n,r;return e=Date.now(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r=n.replace(/[xy]/g,function(t){var n;return n=(e+16*Math.random())%16|0,e=Math.floor(e/16),"x"===t?n.toString(16):(7&n|8).toString(16)}),(t||"")+r.replace(/-/g,"").toUpperCase()}function c(t){var e,n;for(e in t)n=t[e],t[e]=n;var r=arguments.length>=2?[].slice.call(arguments,1):[];return r.forEach(function(r){var o;o=[];for(e in r)n=r[e],o.push(t[e]=n);return o}),t}function u(t){return We(function(){var e="0";t.setItem(e,e);var n=t.getItem(e)===e;return t.removeItem(e),n})}function a(t){for(var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n="",r=0;e>r;r+=1)n+=t;return n}function s(t,e,n){return t?t&&t.length>=n?t:t+a(e,Math.ceil(n-t.length)/e.length):t}function f(t,e,n){return function(){Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);var r,o;for(r=0;r<e.length;r+=1)if(o=e[r],We(o,this,arguments)===!1)return;var i=We(t,this,arguments);if(i===!1)return!1;for(r=0;r<n.length;r+=1)o=n[r],We(o,this,arguments);return i}}function g(t){if(!t)return"";var e=t.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return e?e[3]:""}function d(t,e,n){return[].slice.call(t,e,n)}function l(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return t>=1e21&&(t=9527e16),Xe.parseInt(t,n)||e}function p(t){return Math.min(99e19,t)}function m(t){try{return t?JSON.stringify(t):null}catch(e){o("invalid json format")}return null}function b(t){try{return t?JSON.parse(t):null}catch(e){o("invalid json string")}return null}function j(t,e){var n=this;this.duration=e,this.status="running",this.timer=qe(function(){return n.run()},this.duration),this.run=function(){"cancelled"!==n.status&&(Be(n.timer),Ce.attempt(t),n.timer=qe(function(){return n.run()},n.duration))},this.stop=function(){n.status="stopped",Be(n.timer)},this.reset=function(t){"cancelled"!==n.status&&(n.stop(),t&&(n.duration=t),n.run())},this.cancel=function(){this.status="cancelled",Be(this.timer)}}function T(t){Ne&&(Ne.stop(),qe(function(){Ne&&Ne.reset(t)},t),t&&(Fe.interval=t))}function I(){Ne&&(Ne.cancel(),Ne=null)}function v(){Ne&&Ne.stop()}function E(){Ne&&Ne.run()}function h(t,e){Ne=new j(t,e)}function O(){if(Ye)return Ye;if(en+=1,!(en>4)){var t={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"};for(var e in t){var n=t[e];if(n.indexOf(".")>-1){var r=n.split("."),o=Xe[r[0]];if(o&&o[r[1]])return Ye=e,e}else if(Xe[n])return Ye=e,e}}}function y(){var t=Fe.loginTime||Fe.initTime;return{loginTime:t,onlineTime:Ce.parseInt(Date.now()/1e3)-t||1,extendMap:{from:Fe.from,engine:O()||"",app:Fe.app}}}function _(t,e){var n={headerInfo:pn,onlineInfo:y(),errorInfoList:tn.concat(),eventInfoList:mn.concat()};return t&&(n.paymentInfo=t),e&&(n.userInfo=e),n}function S(){mn.length=0,tn.length=0}function A(){if($e&&n($e.createElement)){var t=$e.createElement("div");if(!t)return!1;if(n(t.querySelector)){t.innerHTML="<i></i>";var e=t.querySelector("i");return!!e&&"I"===e.tagName}if(n(t.getElementsByTagName)){var r=t.getElementsByTagName("i");return!!r&&1===r.length}}return!1}function L(t){return pn.appId+"."+t}function N(t,e){t=L(t),fr.setItem(t,e),ar.set(t,e,3650)}function D(t){return t=L(t),fr.getItem(t)||ar.get(t)}function C(t,e){fr.setItem(L(t),e)}function R(t){return fr.getItem(L(t))}function w(t){fr.removeItem(L(t))}function x(){Ue.setItem(xe.LOGOUT_TIME,Ce.parseInt(Date.now()/1e3)),(tn.length||mn.length)&&Ue.setItem(xe.QUIT_SNAPSHOT,Ce.jsonStringify(_()))}function U(){var t=Ue.getItem(xe.QUIT_SNAPSHOT);return t&&Ce.jsonParse(t)}function M(t){bn>=we.MAX_ERROR_COUNT||(tn.push(t),bn+=1)}function P(t){mn.push(t)}function V(t,e){if(!t)return void Ce.tryThrow("Missing eventId");var n=function(t){return t.replace(/%/g,"_")};arguments.length>2&&(e=arguments[2]);var r={};if(Ce.isObject(e))for(var o in e)r[n(o)]="number"==typeof e[o]?e[o]:encodeURIComponent(e[o]);var i={eventId:n(t),eventMap:r};return Re.addEvent(i),e&&e.immediate?(De.stop(),De.run(),!1):void 0}function G(){return pn.uid||""}function H(t){var e=Xe.egret,n=new e.URLLoader,r=Date.now();n.addEventListener(e.Event.COMPLETE,function(e){var n=Date.now()-r,o=e.target,i="success"===o.data;Ce.attempt(i?t.success:t.error,o,[o,n,n>=t.timeout]),Ce.attempt(t.complete,o,[o,n])});var o=new e.URLRequest(t.url);o.method=t.method||e.URLRequestMethod.POST,o.data=Ce.jsonStringify(t.data),n.load(o)}function F(){return Xe.cc.loader.getXMLHttpRequest()}function k(t){var e=lr();sr.timeout&&(e.timeout=t.timeout),e.open(t.method||"POST",t.url,!0),sr.setContentType(e,"text/plain; charset=UTF-8");var n=Date.now();e.onreadystatechange=function(){if(4===this.readyState){var e=this.status>=200&&this.status<300,r=Date.now()-n;Ce.attempt(e?t.success:t.error,this,[this,r]),Ce.attempt(t.complete,this,[this,r]),this.onreadystatechange=null,this.ontimeout=null}},sr.timeout&&(e.ontimeout=function(){var e=Date.now()-n;Ce.attempt(t.error,this,[this,e,!0]),Ce.attempt(t.complete,this,[this,e]),this.onreadystatechange=null,this.ontimeout=null}),e.send(Ce.jsonStringify(t.data))}function X(){var t=!0,e=!0,n=lr();try{n.timeout=1}catch(r){t=!1}try{n.contentType="text/plain; charset=UTF-8"}catch(r){e=!1}var o=Me.useXDR?function(t,n){e&&(t.contentType=n)}:function(t,e){t.setRequestHeader("Content-Type",e)};return{timeout:t,contentType:e,setContentType:o}}function q(e,n){var r=Date.now();if(!n){if(r-Tr<we.ASAP_TIMEOUT)return void Ce.tryThrow("Request dropped: rate limit");Tr=r}jr+=1,t.report=e.data,pr({url:e.url,data:e.data,success:function(t,n){Ce.attempt(e.success,t,[t,n])},error:function(t,n,r){gr+=1,Ce.attempt(e.error,t,[t,n,r])},complete:function(t,n){if(Ce.attempt(e.complete,t,[t,n]),t.getAllResponseHeaders&&t.getResponseHeader){var r=t.getAllResponseHeaders(),o="X-Rate-Limit";if(-1!==r.indexOf(o)){var i=Ce.parseInt(t.getResponseHeader(o));i>1&&De.reset(1e3*i)}}}})}function B(t){if(!t)return!1;var e=t.onlineInfo.onlineTime;return 1>e||e>we.MAX_ONLINE_TIME?(Ce.tryThrow("Illegal online time"),!1):!0}function K(){return Fe.inited?void 0:(Ce.tryThrow("DCAgent.init needed"),!1)}function Y(){return Fe.loginTime?void 0:(Ce.tryThrow("DCAgent.login needed"),!1)}function z(){return Fe.destroyed?(Ce.tryThrow("DCAgent is destroyed already"),!1):void 0}function Q(t){return t+"?__deuid="+pn.uid+"&__deappid="+pn.appId}function J(t){return t+"?type=h520&appId="+pn.appId+"&uid="+pn.uid+"&mac="+(pn.mac||"")+"&imei="+(pn.imei||"")+"&idfa="+(pn.idfa||"")}function W(t,e,n){if(t||!Ce.hiddenProperty||!$e[Ce.hiddenProperty]){var r={url:Ve.appendOnline(Ve.API_PATH)},o=1;jr&&jr%Fe.oss===0&&(Re.addEvent({eventId:xe.REQ_KEY,eventMap:{succ:jr-gr,fail:gr,total:jr}}),o+=1),r.data=Re.collect(e,n);var i=r.data.eventInfoList[r.data.eventInfoList.length-o];if(i&&i.eventMap&&i.eventMap.immediate&&(t=!0),Pe.isParamsValid(r.data)){Re.clear();var c=r.data.errorInfoList,u=r.data.eventInfoList;(u.length||c.length)&&(r.error=function(){c.forEach(function(t){Re.addError(t)}),u.forEach(function(t){Re.addEvent(t)})}),q(r,t)}}}function $(t){t||(t=we.ASAP_TIMEOUT),Be(mr),De.stop(),mr=qe(function(){De.run()},t)}function Z(t){if(!t)return void Ce.tryThrow("Missing accountID");if(pn.accountId===t)return void(Fe.loginTime=Fe.loginTime||Ce.parseInt(Date.now()/1e3));Ge.setPollingDebounce(Fe.interval),W(!0),Fe.loginTime=Ce.parseInt(Date.now()/1e3);var e=xe.ACCOUNT_RELATED_SETTINGS+","+xe.ACCOUNT_ROLE_SETTINGS;e.split(",").forEach(function(t){return pn[t]=""}),pn.age=we.DEFAULT_AGE,pn.gender=we.DEFAULT_GENDER,pn.roleLevel=we.DEFAULT_ROLE_LEVEL,pn.accountId=t,W(!0)}function te(t,e,n,r){var o=arguments;xe.ACCOUNT_ROLE_SETTINGS.split(",").forEach(function(t,e){return pn[t]=o[e]||""}),pn.roleLevel=Ce.parseInt(r)||1}function ee(t,e,n,r){te(t,e,n,r),V("DE_EVENT_CREATE_ROLE",{roleId:String(t),roleRace:String(e),roleClass:String(n)})}function ne(t){pn.gender=2===t?2:1}function re(t){pn.gameServer=String(t)}function oe(t){t=Ce.parseInt(t),pn.age=t>0&&128>t?t:0}function ie(t){pn.accountType=String(t)}function ce(t,e){return e=Ce.parseInt(e),0>e?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_TASK,{actionType:"taskUnfinish",taskId:String(t),elapsed:e})}function ue(t,e){return e=Ce.parseInt(e),0>e?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_TASK,{actionType:"taskFinish",taskId:String(t),elapsed:e})}function ae(t){if(!t||!t.hasOwnProperty("amount"))return void Ce.tryThrow("Missing amount");var e={currencyAmount:Ce.max(parseFloat(t.amount,10)||0),currencyType:t.currencyType||"CNY",payType:String(t.payType||""),iapid:String(t.iapid||""),payTime:Ce.parseInt(Date.now()/1e3),extendMap:{orderId:String(t.orderId||"")}};return e.currencyAmount<=0?void Ce.tryThrow("amount must be greater than 0"):(W(!0,e),e)}function se(t,e){return e=Ce.parseInt(e),0>e?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_MISSION,{actionType:"guankaUnfinish",guankaId:String(t),duration:e})}function fe(t,e){return e=Ce.parseInt(e),0>e?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_MISSION,{actionType:"guankaFinish",guankaId:String(t),duration:e})}function ge(t,e,n){return t=Ce.parseInt(t),e=Ce.parseInt(e),n=Ce.parseInt(n),0>t||0>e||t>e||0>n?(Ce.tryThrow("Argument error"),!1):(pn.roleLevel=e,void V(xe.EVT_LEVEL,{startLevel:t,endLevel:e,duration:n}))}function de(t,e,n,r){return e=Ce.parseInt(e),0>e?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_ITEM,{actionType:"itemUse",itemId:String(t),itemNum:e,reason:String(r),missonID:String(n)})}function le(t,e,n,r){return e=Ce.parseInt(e),0>e?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_ITEM,{actionType:"itemGet",itemId:String(t),itemNum:e,reason:String(r),missonID:String(n)})}function pe(t,e,n,r,o){return e=Ce.parseInt(e),r=Ce.parseInt(r),0>e||0>r?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_ITEM,{actionType:"itemBuy",itemId:String(t),itemNum:e,coinType:String(n),coinNum:r,missonID:String(o)})}function me(t,e,n,r){return e=Ce.parseInt(e),t=Ce.parseInt(t),0>e||0>t?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_COIN,{actionType:"coinUse",coinType:String(n),balanceNum:e,coinNum:t,reason:String(r)})}function be(t,e,n,r){return e=Ce.parseInt(e),t=Ce.parseInt(t),0>e||0>t||t>e?(Ce.tryThrow("Argument error"),!1):void V(xe.EVT_COIN,{actionType:"coinGet",coinType:String(n),balanceNum:e,coinNum:t,reason:String(r)})}function je(){for(var t=["pagehide","beforeunload","unload"],e=0;e<t.length;e+=1)if("on"+t[e]in Xe)return t[e]}function Te(t){if(Xe.addEventListener){var e=je();e&&Xe.addEventListener(e,t)}}function Ie(t){if(Fe.storage&&(Te(Re.saveToStorage),!t)){var e=Re.loadFromStorage();e&&(q({url:Ve.appendOnline(Ve.API_PATH),data:e},!0),Ue.removeItem(xe.QUIT_SNAPSHOT))}}function ve(){Xe.addEventListener&&Xe.addEventListener("error",function(t){Ce.attempt(function(){var e={},n=["colno","filename","lineno","message"];n.forEach(function(n){return e[n]=t[n]||"1"});var r=t.error||{};if(e.stack=encodeURIComponent(r.stack||r.stacktrace||""),e.type=r.name||"Error",e.timestamp=parseInt(t.timeStamp/1e3),Ce.isFunction(Fe.getErrorScene)){var o=Ce.attempt(Fe.getErrorScene,r,[t]);if(o){if(Ce.isObject(o)){var i="";for(var c in o)i+="	"+c+"="+o[c]+"\n";o=i}else o=String(o);e.stack+="\n\nError scene:\n"+encodeURIComponent(o)}}Re.addError(e)})},!1)}function Ee(){var t=Date.now().toString(36).toUpperCase(),e=He.engine;return e.egret?xe.EGRET_PREFIX+t:e.layabox?xe.LAYA_PREFIX+t:e.cocos?xe.COCOS_PREFIX+t:xe.UNKNOW_ENGINE+t}function he(){var t;try{if(He.engine.layabox){var e=Xe.layabox.getDeviceInfo()||{};t=e.mac||e.idfa,t=t&&t.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(n){t=null}return t=Ce.padding(t,xe.PADDING_STRING,we.UID_MIN_LENGTH),t||Ce.uuid(Ee())}function Oe(t){if(pn.uid){var e=Ce.padding(pn.uid,xe.PADDING_STRING,we.UID_MIN_LENGTH);t!==e&&(pn.uid=e,t=e,Ue.setItem(xe.CREATE_TIME,Ce.parseInt(Date.now()/1e3)))}var n=t||he();return Ue.setUID(xe.CLIENT_KEY,n),n}function ye(t){var e=Ue.getUID(xe.CLIENT_KEY),n=e?0:1,r=Oe(e);pn.uid=r,pn.accountId=r,t.errorReport&&ve(),Fe.initTime=Ce.parseInt(Date.now()/1e3);var o=Ue.getItem(xe.CREATE_TIME);o||(o=Fe.initTime,Ue.setItem(xe.CREATE_TIME,o)),Fe.createTime=Ce.parseInt(o);var i=or.href||"!";Re.addEvent({eventId:xe.EVT_PV,eventMap:{page:encodeURI(i.split("?")[0])}});var c=n?{actTime:o,regTime:o}:null;W(!0,null,c),Ie(n);var u=1e3*Math.max(we.MIN_ONLINE_INTERVAL,parseFloat(t.interval||we.MIN_ONLINE_INTERVAL));De.set(W,u),Fe.interval=u,Fe.inited=!0}function _e(t){return Fe.storage=Ce.isLocalStorageSupported(Ue),t.uid||Fe.storage?Fe.inited?"Initialization ignored":t&&t.appId?(t.appId=t.appId.toUpperCase(),Fe.oss="number"==typeof t.oss?t.oss:0,Fe.getErrorScene=t.getErrorScene,Fe.app=t.appName||"",Fe.from=t.from||Ce.getHostName($e.referrer),void xe.USER_INIT_BASE_SETTINGS.split(",").forEach(function(e){t.hasOwnProperty(e)&&(pn[e]=t[e])})):"Missing appId":Me.hasStorage?"Storage quota error":"Storage not support"}function Se(t){if(Pe.shouldNotBeDestoryed()!==!1){var e=_e(t);if(e)return Ce.tryThrow(e);ye(t),Ce.isDebug||q({url:Ve.appendEcho(Me.protocol+"//"+xe.HOST+"/echo"),method:"GET"},!0)}}function Ae(){return Fe.inited}function Le(){I(),Fe.destroyed=!0}var Ne,De={get reset(){return T},get cancel(){return I},get stop(){return v},get run(){return E},get set(){return h}},Ce={get isDebug(){return Qe},get noop(){return e},get isFunction(){return n},get isObject(){return r},get log(){return o},get tryThrow(){return Je},get uuid(){return i},get extend(){return c},get attempt(){return We},get isLocalStorageSupported(){return u},get repeat(){return a},get padding(){return s},get aspect(){return f},get getHostName(){return g},get hiddenProperty(){return Ze},get slice(){return d},get parseInt(){return l},get max(){return p},get jsonStringify(){return m},get jsonParse(){return b}},Re={get getOnlineInfo(){return y},get collect(){return _},get clear(){return S},get saveToStorage(){return x},get loadFromStorage(){return U},get addError(){return M},get addEvent(){return P}},we={get REQUEST_TIME_OUT(){return nn},get MAX_ONLINE_TIME(){return rn},get MIN_ONLINE_INTERVAL(){return on},get UID_MIN_LENGTH(){return cn},get ASAP_TIMEOUT(){return un},get MAX_ERROR_COUNT(){return an},get DEFAULT_AGE(){return sn},get DEFAULT_GENDER(){return fn},get DEFAULT_ROLE_LEVEL(){return gn},get DEFAULT_NET_TYPE(){return dn},get DEFAULT_PLATFORM(){return ln}},xe={get HOST(){return Dn},get CREATE_TIME(){return Cn},get EGRET_PREFIX(){return Rn},get LAYA_PREFIX(){return wn},get COCOS_PREFIX(){return xn},get UNKNOW_ENGINE(){return Un},get PARENT_KEY(){return Mn},get EVENTS_KEY(){return Pn},get ERRORS_KEY(){return Vn},get CLIENT_KEY(){return Gn},get QUIT_SNAPSHOT(){return Hn},get LOGOUT_TIME(){return Fn},get API_PATH(){return kn},get PADDING_STRING(){return Xn},get REQ_KEY(){return qn},get USER_INIT_BASE_SETTINGS(){return Bn},get ACCOUNT_RELATED_SETTINGS(){return Kn},get ACCOUNT_ROLE_SETTINGS(){return Yn},get EVT_COIN(){return zn},get EVT_ITEM(){return Qn},get EVT_LEVEL(){return Jn},get EVT_MISSION(){return Wn},get EVT_TASK(){return $n},get EVT_PV(){return Zn}},Ue={get setUID(){return N},get getUID(){return D},get setItem(){return C},get getItem(){return R},get removeItem(){return w}},Me={get hasStorage(){return er},get isStandardBrowser(){return nr},get hasCookie(){return rr},get protocol(){return ir},get useXDR(){return cr},get device(){return An}},Pe={get isParamsValid(){return B},get shouldBeInited(){return K},get shouldBeLoggedIn(){return Y},get shouldNotBeDestoryed(){return z}},Ve={get API_PATH(){return Ir},get appendOnline(){return Q},get appendEcho(){return J}},Ge={get setPollingDebounce(){return $}},He={get engine(){return Ke},get"default"(){return O}},Fe={inited:!1},ke=(1,eval)("this"),Xe=ke||{},qe=Xe.setTimeout,Be=Xe.clearTimeout,Ke={isEgret:!!Xe.egret,isLayabox:!!Xe.layabox,isCocos:!!Xe.cc&&!!Xe.cc.game};Ke.isEgret&&!qe&&(qe=function(t,e){Xe.egret.setTimeout(t,Xe,e)},Be=function(t){Xe.egret.clearTimeout(t)});var Ye,ze=Object.prototype.toString,Qe=Xe.DCAGENT_DEBUG_OPEN,Je=Qe?function(t){throw new Error(t)}:function(t){o(t)},We=Qe?function(t,e,r){return n(t)?t.apply(e,r):void 0}:function(t,e,r){if(n(t))try{return t.apply(e,r)}catch(i){o("exec error for function:\n "+t.toString())}},$e=ke.document||{},Ze="hidden"in $e?"hidden":"webkitHidden"in $e?"webkitHidden":"mozHidden"in $e?"mozHidden":"msHidden"in $e?"msHidden":null,tn=[],en=0;t.version=27;var nn=3e4,rn=172800,on=40,cn=32,un=5e3,an=100,sn=0,fn=0,gn=0,dn=3,ln=0,pn={accountId:"",accountType:"",age:we.DEFAULT_AGE,appId:"",appVersion:"",brand:"",channel:"",customDeviceId:"",gameServer:"",gender:we.DEFAULT_GENDER,idfa:"",imei:"",lonLat:"",mac:"",netType:we.DEFAULT_NET_TYPE,operator:"",osVersion:"",platform:we.DEFAULT_PLATFORM,resolution:"",roleClass:"",roleId:"",roleLevel:we.DEFAULT_ROLE_LEVEL,roleRace:"",simCardOp:"",uid:"",ver:t.version},mn=[],bn=0,jn=we.DEFAULT_PLATFORM,Tn=Xe.screen||{},In=Tn.width&&Tn.width+"*"+Tn.height,vn="0*0";In||(In=vn);var En="",hn="",On=Xe.navigator&&Xe.navigator.userAgent||"";if(!On){var yn=["ios","android"];if(Ke.layabox){var _n=Xe.layabox.getDeviceInfo()||{};In=_n.resolution||vn,hn=_n.phonemodel,jn=yn.indexOf(_n.os.toLowerCase()),En=(_n.os+" "+_n.osversion).toLowerCase()}else if(Ke.cocos){var Sn=Xe.cc.view.getViewPortRect()||{};In=Sn.width+"*"+Sn.height,jn=yn.indexOf(Xe.cc.sys.os.toLowerCase())}-1===[0,1,2,3].indexOf(jn)&&(jn=we.DEFAULT_PLATFORM)}var An={resolution:In,brand:hn,osVersion:En,platform:jn};for(var Ln in An)pn[Ln]=pn[Ln]||An[Ln];var Nn,Dn="rd.gdatacube.net",Cn="dcagent_create_time",Rn="EGRET",wn="LAYA",xn="COCOS",Un="UE",Mn="dcagent_parent_id",Pn="dcagent_client_events",Vn="dcagent_client_errors",Gn="dcagent_client_id",Hn="dcagent_snapshot",Fn="dc_p_lo",kn="/dc/hh5/sync",Xn="0A",qn="DE_EVENT_OSS",Bn="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",Kn="accountId,accountType,age,gender,gameServer",Yn="roleId,roleRace,roleClass,roleLevel",zn="DE_EVENT_COIN_ACTION",Qn="DE_EVENT_ITEM_ACTION",Jn="DE_EVENT_LEVELUP",Wn="DE_EVENT_GUANKA_ACTION",$n="DE_EVENT_TASK_ACTION",Zn="DE_EVENT_PV",tr={get:function(t){var e="(^|)\\s*"+t+"=([^\\s]*)",n=$e.cookie.match(new RegExp(e));return n&&n.length>=3?decodeURIComponent(n[2]):null},set:function(t,e,n,r,o,i){var c;n&&(c=new Date,c.setTime(c.getTime()+864e5*n));var u=n?" expires="+c.toGMTString():"",a=" path="+(o||"/"),s=r?" domain="+r:"",f=i?" secure":"";$e.cookie=t+"="+encodeURIComponent(e)+u+a+s+f},remove:function(t,e,n){tr.set(t,"",-1,e,n)}},er=!!Xe.localStorage||Ke.isEgret||Ke.isCocos||Ke.isLayabox,nr=A(),rr=nr&&"cookie"in $e,or=ke.location||{},ir="https:"===or.protocol?"https:":"http:",cr=!!Xe.XDomainRequest,ur=Me.hasCookie?tr:{get:Ce.noop,set:Ce.noop},ar=ur;Nn=Ke.isEgret?Xe.egret.localStorage:Ke.isCocos?Xe.cc.sys.localStorage:er?Xe.localStorage:{getItem:e,setItem:e,removeItem:e};var sr,fr=Nn,gr=0,dr=Me.useXDR?function(){return new Xe.XDomainRequest}:function(){return new Xe.XMLHttpRequest},lr=Ke.isCocos?F:dr,pr=function(){return Xe.XMLHttpRequest||Ke.isCocos?(sr=X(),k):Ke.isEgret?H:(Ce.log("XMLHttpRequest not found"),Ce.noop)}();t.report;var mr,br,jr=0,Tr=Date.now()-we.ASAP_TIMEOUT,Ir=Me.protocol+"//"+xe.HOST+xe.API_PATH,vr={login:Z,getUid:G,onEvent:V},Er={onCoinGet:be,onCoinUse:me,onItemBuy:pe,onItemProduce:le,onItemUse:de,onLevelUp:ge,onMissionFinished:fe,onMissionUnfinished:se,onPayment:ae,onTaskFinished:ue,onTaskUnfinished:ce,setAccountType:ie,setAge:oe,setGameServer:re,setGender:ne,setRoleInfo:te,createRole:ee},hr=[Pe.shouldNotBeDestoryed,Pe.shouldBeInited],Or=[Pe.shouldNotBeDestoryed,Pe.shouldBeLoggedIn],yr=[function(){return Ge.setPollingDebounce()}];for(br in vr)t[br]=Ce.aspect(vr[br],hr,"onEvent"===br&&yr);for(br in Er)t[br]=Ce.aspect(Er[br],Or,"onPayment"!==br&&yr);t.init=Se,t.isReady=Ae,t.destroy=Le;var _r=Xe.DCAgentObject;if(_r){var Sr=Xe[_r];if(Ce.isFunction(Sr)){var Ar=Sr.cache;Ar.length&&(Ar.forEach(function(e){Ce.attempt(t[e[0]],t,Ce.slice(e,1))}),Ar.length=0)}}var Lr={get isNew(){var t=Fe.loginTime||Fe.initTime;return Fe.createTime===t},get initTime(){return Fe.initTime},get createTime(){return Fe.createTime},get loginTime(){return Fe.loginTime},get lastLogoutTime(){return parseInt(Ue.getItem(xe.LOGOUT_TIME))},get reportCount(){return jr},get reportFailedCount(){return gr}};t.state=Fe,t.player=Lr});