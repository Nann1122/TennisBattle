this.j$=this.jStat=function(n,t){function r(t,r){var e=t>r?t:r;return n.pow(10,17-~~(n.log(e>0?e:-e)*n.LOG10E))}function e(n){return"[object Function]"===m.call(n)}function o(n){return"number"==typeof n&&n===n}function u(n){return l.apply([],n)}function i(){return new i._init(arguments)}function a(){return 0}function f(){return 1}function c(n,t){return n===t?1:0}var l=Array.prototype.concat,s=Array.prototype.slice,m=Object.prototype.toString,p=Array.isArray||function(n){return"[object Array]"===m.call(n)};i.fn=i.prototype,i._init=function(n){var t;if(p(n[0]))if(p(n[0][0])){for(e(n[1])&&(n[0]=i.map(n[0],n[1])),t=0;t<n[0].length;t++)this[t]=n[0][t];this.length=n[0].length}else this[0]=e(n[1])?i.map(n[0],n[1]):n[0],this.length=1;else if(o(n[0]))this[0]=i.seq.apply(null,n),this.length=1;else{if(n[0]instanceof i)return i(n[0].toArray());this[0]=[],this.length=1}return this},i._init.prototype=i.prototype,i._init.constructor=i,i.utils={calcRdx:r,isArray:p,isFunction:e,isNumber:o,toVector:u},i.extend=function(n){var t,r;if(1===arguments.length){for(r in n)i[r]=n[r];return this}for(t=1;t<arguments.length;t++)for(r in arguments[t])n[r]=arguments[t][r];return n},i.rows=function(n){return n.length||1},i.cols=function(n){return n[0].length||1},i.dimensions=function(n){return{rows:i.rows(n),cols:i.cols(n)}},i.row=function(n,t){return n[t]},i.col=function(n,t){for(var r=new Array(n.length),e=0;e<n.length;e++)r[e]=[n[e][t]];return r},i.diag=function(n){for(var t=i.rows(n),r=new Array(t),e=0;t>e;e++)r[e]=[n[e][e]];return r},i.antidiag=function(n){for(var t=i.rows(n)-1,r=new Array(t),e=0;t>=0;t--,e++)r[e]=[n[e][t]];return r},i.transpose=function(n){var t,r,e,o,u,i=[];for(p(n[0])||(n=[n]),r=n.length,e=n[0].length,u=0;e>u;u++){for(t=new Array(r),o=0;r>o;o++)t[o]=n[o][u];i.push(t)}return 1===i.length?i[0]:i},i.map=function(n,t,r){var e,o,u,i,a;for(p(n[0])||(n=[n]),o=n.length,u=n[0].length,i=r?n:new Array(o),e=0;o>e;e++)for(i[e]||(i[e]=new Array(u)),a=0;u>a;a++)i[e][a]=t(n[e][a],e,a);return 1===i.length?i[0]:i},i.cumreduce=function(n,t,r){var e,o,u,i,a;for(p(n[0])||(n=[n]),o=n.length,u=n[0].length,i=r?n:new Array(o),e=0;o>e;e++)for(i[e]||(i[e]=new Array(u)),u>0&&(i[e][0]=n[e][0]),a=1;u>a;a++)i[e][a]=t(i[e][a-1],n[e][a]);return 1===i.length?i[0]:i},i.alter=function(n,t){return i.map(n,t,!0)},i.create=function(n,t,r){var o,u,i=new Array(n);for(e(t)&&(r=t,t=n),o=0;n>o;o++)for(i[o]=new Array(t),u=0;t>u;u++)i[o][u]=r(o,u);return i},i.zeros=function(n,t){return o(t)||(t=n),i.create(n,t,a)},i.ones=function(n,t){return o(t)||(t=n),i.create(n,t,f)},i.rand=function(t,r){return o(r)||(r=t),i.create(t,r,n.random)},i.identity=function(n,t){return o(t)||(t=n),i.create(n,t,c)},i.symmetric=function(n){var t,r,e=n.length;if(n.length!==n[0].length)return!1;for(t=0;e>t;t++)for(r=0;e>r;r++)if(n[r][t]!==n[t][r])return!1;return!0},i.clear=function(n){return i.alter(n,a)},i.seq=function(n,t,o,u){e(u)||(u=!1);var i,a=[],f=r(n,t),c=(t*f-n*f)/((o-1)*f),l=n;for(i=0;t>=l;i++,l=(n*f+c*f*i)/f)a.push(u?u(l,i):l);return a};var g=i.prototype;return g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},g.map=function(n,t){return i(i.map(this,n,t))},g.cumreduce=function(n,t){return i(i.cumreduce(this,n,t))},g.alter=function(n){return i.alter(this,n),this},function(n){for(var t=0;t<n.length;t++)(function(n){g[n]=function(t){var r,e=this;return t?(setTimeout(function(){t.call(e,g[n].call(e))}),this):(r=i[n](this),p(r)?i(r):r)}})(n[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){g[n]=function(t,r){var e=this;return r?(setTimeout(function(){r.call(e,g[n].call(e,t))}),this):i(i[n](this,t))}})(n[t])}("row col".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){g[n]=new Function("return jStat(jStat."+n+".apply(null, arguments));")})(n[t])}("create zeros ones rand identity".split(" ")),i}(Math),function(n,t){function r(n,t){return n-t}function e(n,r,e){return t.max(r,t.min(n,e))}var o=n.utils.isFunction;n.sum=function a(n){for(var a=0,t=n.length;--t>=0;)a+=n[t];return a},n.sumsqrd=function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r]*n[r];return t},n.sumsqerr=function(t){for(var r,e=n.mean(t),o=0,u=t.length;--u>=0;)r=t[u]-e,o+=r*r;return o},n.sumrow=function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r];return t},n.product=function(n){for(var t=1,r=n.length;--r>=0;)t*=n[r];return t},n.min=function(n){for(var t=n[0],r=0;++r<n.length;)n[r]<t&&(t=n[r]);return t},n.max=function(n){for(var t=n[0],r=0;++r<n.length;)n[r]>t&&(t=n[r]);return t},n.mean=function(t){return n.sum(t)/t.length},n.meansqerr=function(t){return n.sumsqerr(t)/t.length},n.geomean=function(r){return t.pow(n.product(r),1/r.length)},n.median=function(n){var t=n.length,e=n.slice().sort(r);return 1&t?e[t/2|0]:(e[t/2-1]+e[t/2])/2},n.cumsum=function(t){return n.cumreduce(t,function(n,t){return n+t})},n.cumprod=function(t){return n.cumreduce(t,function(n,t){return n*t})},n.diff=function(n){var t,r=[],e=n.length;for(t=1;e>t;t++)r.push(n[t]-n[t-1]);return r},n.mode=function(n){var t,e=n.length,o=n.slice().sort(r),u=1,i=0,a=0,f=[];for(t=0;e>t;t++)o[t]===o[t+1]?u++:(u>i?(f=[o[t]],i=u,a=0):u===i&&(f.push(o[t]),a++),u=1);return 0===a?f[0]:f},n.range=function(t){return n.max(t)-n.min(t)},n.variance=function(t,r){return n.sumsqerr(t)/(t.length-(r?1:0))},n.stdev=function(r,e){return t.sqrt(n.variance(r,e))},n.meandev=function(r){var e,o=0,u=n.mean(r);for(e=r.length-1;e>=0;e--)o+=t.abs(r[e]-u);return o/r.length},n.meddev=function(r){var e,o=0,u=n.median(r);for(e=r.length-1;e>=0;e--)o+=t.abs(r[e]-u);return o/r.length},n.coeffvar=function(t){return n.stdev(t)/n.mean(t)},n.quartiles=function(n){var e=n.length,o=n.slice().sort(r);return[o[t.round(e/4)-1],o[t.round(e/2)-1],o[t.round(3*e/4)-1]]},n.quantiles=function(n,o,u,i){var a,f,c,l,s,m,p=n.slice().sort(r),g=[o.length],d=n.length;for("undefined"==typeof u&&(u=3/8),"undefined"==typeof i&&(i=3/8),a=0;a<o.length;a++)f=o[a],c=u+f*(1-u-i),l=d*f+c,s=t.floor(e(l,1,d-1)),m=e(l-s,0,1),g[a]=(1-m)*p[s-1]+m*p[s];return g},n.percentileOfScore=function(n,t,r){var e,o,u=0,i=n.length,a=!1;for("strict"===r&&(a=!0),o=0;i>o;o++)e=n[o],(a&&t>e||!a&&t>=e)&&u++;return u/i},n.histogram=function(r,e){var o,u=n.min(r),i=e||4,a=(n.max(r)-u)/i,f=r.length,e=[];for(o=0;i>o;o++)e[o]=0;for(o=0;f>o;o++)e[t.min(t.floor((r[o]-u)/a),i-1)]+=1;return e},n.covariance=function(t,r){var e,o=n.mean(t),u=n.mean(r),i=t.length,a=new Array(i);for(e=0;i>e;e++)a[e]=(t[e]-o)*(r[e]-u);return n.sum(a)/(i-1)},n.corrcoeff=function(t,r){return n.covariance(t,r)/n.stdev(t,1)/n.stdev(r,1)},n.stanMoment=function(r,e){var o=n.mean(r),u=n.stdev(r),a=r.length,f=0;for(i=0;i<a;i++)f+=t.pow((r[i]-o)/u,e);return f/r.length},n.skewness=function(t){return n.stanMoment(t,3)},n.kurtosis=function(t){return n.stanMoment(t,4)-3};var u=n.prototype;!function(t){for(var r=0;r<t.length;r++)(function(t){u[t]=function(r,e){var i=[],a=0,f=this;if(o(r)&&(e=r,r=!1),e)return setTimeout(function(){e.call(f,u[t].call(f,r))}),this;if(this.length>1){for(f=r===!0?this:this.transpose();a<f.length;a++)i[a]=n[t](f[a]);return i}return n[t](this[0],r)}})(t[r])}("cumsum cumprod".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){u[t]=function(r,e){var i=[],a=0,f=this;if(o(r)&&(e=r,r=!1),e)return setTimeout(function(){e.call(f,u[t].call(f,r))}),this;if(this.length>1){for("sumrow"!==t&&(f=r===!0?this:this.transpose());a<f.length;a++)i[a]=n[t](f[a]);return r===!0?n[t](n.utils.toVector(i)):i}return n[t](this[0],r)}})(t[r])}("sum sumsqrd sumsqerr sumrow product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){u[t]=function(){var r=[],e=0,i=this,a=Array.prototype.slice.call(arguments);if(o(a[a.length-1])){var f=a[a.length-1],c=a.slice(0,a.length-1);return setTimeout(function(){f.call(i,u[t].apply(i,c))}),this}var f=void 0,l=function(r){return n[t].apply(i,[r].concat(a))};if(this.length>1){for(i=i.transpose();e<i.length;e++)r[e]=l(i[e]);return r}return l(this[0])}})(t[r])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(n,t){n.gammaln=function(n){var r,e,o,u=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(o=(e=r=n)+5.5,o-=(r+.5)*t.log(o);6>u;u++)a+=i[u]/++e;return t.log(2.5066282746310007*a/r)-o},n.gammafn=function(n){var r,e,o,u,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,l=0,s=0,m=n;if(0>=m){if(u=m%1+3.6e-16,!u)return 1/0;f=(1&m?-1:1)*t.PI/t.sin(t.PI*u),m=1-m}for(o=m,e=1>m?m++:(m-=c=(0|m)-1)-1,r=0;8>r;++r)s=(s+i[r])*e,l=l*e+a[r];if(u=s/l+1,m>o)u/=o;else if(o>m)for(r=0;c>r;++r)u*=m,m++;return f&&(u=f/u),u},n.gammap=function(t,r){return n.lowRegGamma(t,r)*n.gammafn(t)},n.lowRegGamma=function(r,e){var o,u=n.gammaln(r),i=r,a=1/r,f=a,c=e+1-r,l=1/1e-30,s=1/c,m=s,p=1,g=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);if(0>e||0>=r)return 0/0;if(r+1>e){for(;g>=p;p++)a+=f*=e/++i;return a*t.exp(-e+r*t.log(e)-u)}for(;g>=p;p++)o=-p*(p-r),c+=2,s=o*s+c,l=c+o/l,s=1/s,m*=s*l;return 1-m*t.exp(-e+r*t.log(e)-u)},n.factorialln=function(t){return 0>t?0/0:n.gammaln(t+1)},n.factorial=function(t){return 0>t?0/0:n.gammafn(t+1)},n.combination=function(r,e){return r>170||e>170?t.exp(n.combinationln(r,e)):n.factorial(r)/n.factorial(e)/n.factorial(r-e)},n.combinationln=function(t,r){return n.factorialln(t)-n.factorialln(r)-n.factorialln(t-r)},n.permutation=function(t,r){return n.factorial(t)/n.factorial(t-r)},n.betafn=function(r,e){return 0>=r||0>=e?void 0:r+e>170?t.exp(n.betaln(r,e)):n.gammafn(r)*n.gammafn(e)/n.gammafn(r+e)},n.betaln=function(t,r){return n.gammaln(t)+n.gammaln(r)-n.gammaln(t+r)},n.betacf=function(n,r,e){var o,u,i,a,f=1e-30,c=1,l=r+e,s=r+1,m=r-1,p=1,g=1-l*n/s;for(t.abs(g)<f&&(g=f),g=1/g,a=g;100>=c&&(o=2*c,u=c*(e-c)*n/((m+o)*(r+o)),g=1+u*g,t.abs(g)<f&&(g=f),p=1+u/p,t.abs(p)<f&&(p=f),g=1/g,a*=g*p,u=-(r+c)*(l+c)*n/((r+o)*(s+o)),g=1+u*g,t.abs(g)<f&&(g=f),p=1+u/p,t.abs(p)<f&&(p=f),g=1/g,i=g*p,a*=i,!(t.abs(i-1)<3e-7));c++);return a},n.gammapinv=function(r,e){var o,u,i,a,f,c,l,s=0,m=e-1,p=1e-8,g=n.gammaln(e);if(r>=1)return t.max(100,e+100*t.sqrt(e));if(0>=r)return 0;for(e>1?(c=t.log(m),l=t.exp(m*(c-1)-g),f=.5>r?r:1-r,i=t.sqrt(-2*t.log(f)),o=(2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i,.5>r&&(o=-o),o=t.max(.001,e*t.pow(1-1/(9*e)-o/(3*t.sqrt(e)),3))):(i=1-e*(.253+.12*e),o=i>r?t.pow(r/i,1/e):1-t.log(1-(r-i)/(1-i)));12>s;s++){if(0>=o)return 0;if(u=n.lowRegGamma(e,o)-r,i=e>1?l*t.exp(-(o-m)+m*(t.log(o)-c)):t.exp(-o+m*t.log(o)-g),a=u/i,o-=i=a/(1-.5*t.min(1,a*((e-1)/o-1))),0>=o&&(o=.5*(o+i)),t.abs(i)<p*o)break}return o},n.erf=function(n){var r,e,o,u,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],a=i.length-1,f=!1,c=0,l=0;for(0>n&&(n=-n,f=!0),r=2/(2+n),e=4*r-2;a>0;a--)o=c,c=e*c-l+i[a],l=o;return u=r*t.exp(-n*n+.5*(i[0]+e*c)-l),f?u-1:1-u},n.erfc=function(t){return 1-n.erf(t)},n.erfcinv=function(r){var e,o,u,i,a=0;if(r>=2)return-100;if(0>=r)return 100;for(i=1>r?r:2-r,u=t.sqrt(-2*t.log(i/2)),e=-.70711*((2.30753+.27061*u)/(1+u*(.99229+.04481*u))-u);2>a;a++)o=n.erfc(e)-i,e+=o/(1.1283791670955126*t.exp(-e*e)-e*o);return 1>r?e:-e},n.ibetainv=function(r,e,o){var u,i,a,f,c,l,s,m,p,g,d,h=1e-8,v=e-1,y=o-1,w=0;if(0>=r)return 0;if(r>=1)return 1;for(e>=1&&o>=1?(a=.5>r?r:1-r,f=t.sqrt(-2*t.log(a)),s=(2.30753+.27061*f)/(1+f*(.99229+.04481*f))-f,.5>r&&(s=-s),m=(s*s-3)/6,p=2/(1/(2*e-1)+1/(2*o-1)),g=s*t.sqrt(m+p)/p-(1/(2*o-1)-1/(2*e-1))*(m+5/6-2/(3*p)),s=e/(e+o*t.exp(2*g))):(u=t.log(e/(e+o)),i=t.log(o/(e+o)),f=t.exp(e*u)/e,c=t.exp(o*i)/o,g=f+c,s=f/g>r?t.pow(e*g*r,1/e):1-t.pow(o*g*(1-r),1/o)),d=-n.gammaln(e)-n.gammaln(o)+n.gammaln(e+o);10>w;w++){if(0===s||1===s)return s;if(l=n.ibeta(s,e,o)-r,f=t.exp(v*t.log(s)+y*t.log(1-s)+d),c=l/f,s-=f=c/(1-.5*t.min(1,c*(v/s-y/(1-s)))),0>=s&&(s=.5*(s+f)),s>=1&&(s=.5*(s+f+1)),t.abs(f)<h*s&&w>0)break}return s},n.ibeta=function(r,e,o){var u=0===r||1===r?0:t.exp(n.gammaln(e+o)-n.gammaln(e)-n.gammaln(o)+e*t.log(r)+o*t.log(1-r));return 0>r||r>1?!1:(e+1)/(e+o+2)>r?u*n.betacf(r,e,o)/e:1-u*n.betacf(1-r,o,e)/o},n.randn=function(r,e){var o,u,i,a,f;if(e||(e=r),r)return n.create(r,e,function(){return n.randn()});do o=t.random(),u=1.7156*(t.random()-.5),i=o-.449871,a=t.abs(u)+.386595,f=i*i+a*(.196*a-.25472*i);while(f>.27597&&(f>.27846||u*u>-4*t.log(o)*o*o));return u/o},n.randg=function(r,e,o){var u,i,a,f,c,l,s=r;if(o||(o=e),r||(r=1),e)return l=n.zeros(e,o),l.alter(function(){return n.randg(r)}),l;1>r&&(r+=1),u=r-1/3,i=1/t.sqrt(9*u);do{do c=n.randn(),f=1+i*c;while(0>=f);f=f*f*f,a=t.random()}while(a>1-.331*t.pow(c,4)&&t.log(a)>.5*c*c+u*(1-f+t.log(f)));if(r==s)return u*f;do a=t.random();while(0===a);return t.pow(a,1/s)*u*f},function(t){for(var r=0;r<t.length;r++)(function(t){n.fn[t]=function(){return n(n.map(this,function(r){return n[t](r)}))}})(t[r])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){n.fn[t]=function(){return n(n[t].apply(null,arguments))}})(t[r])}("randn".split(" "))}(this.jStat,Math),function(n,t){!function(t){for(var r=0;r<t.length;r++)(function(t){n[t]=function(n,t,r){return this instanceof arguments.callee?(this._a=n,this._b=t,this._c=r,this):new arguments.callee(n,t,r)},n.fn[t]=function(r,e,o){var u=n[t](r,e,o);return u.data=this,u},n[t].prototype.sample=function(r){var e=this._a,o=this._b,u=this._c;return r?n.alter(r,function(){return n[t].sample(e,o,u)}):n[t].sample(e,o,u)},function(r){for(var e=0;e<r.length;e++)(function(r){n[t].prototype[r]=function(e){var o=this._a,u=this._b,i=this._c;return!e&&0!==e&&(e=this.data),"number"!=typeof e?n.fn.map.call(e,function(e){return n[t][r](e,o,u,i)}):n[t][r](e,o,u,i)}})(r[e])}("pdf cdf inv".split(" ")),function(r){for(var e=0;e<r.length;e++)(function(r){n[t].prototype[r]=function(){return n[t][r](this._a,this._b,this._c)}})(r[e])}("mean median mode variance".split(" "))})(t[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal noncentralt normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),n.extend(n.beta,{pdf:function(r,e,o){return r>1||0>r?0:1==e&&1==o?1:512>e||512>o?t.pow(r,e-1)*t.pow(1-r,o-1)/n.betafn(e,o):t.exp((e-1)*t.log(r)+(o-1)*t.log(1-r)-n.betaln(e,o))},cdf:function(t,r,e){return t>1||0>t?1*(t>1):n.ibeta(t,r,e)},inv:function(t,r,e){return n.ibetainv(t,r,e)},mean:function(n,t){return n/(n+t)},median:function(n,t){throw new Error("median not yet implemented")},mode:function(n,t){return(n-1)/(n+t-2)},sample:function(t,r){var e=n.randg(t);return e/(e+n.randg(r))},variance:function(n,r){return n*r/(t.pow(n+r,2)*(n+r+1))}}),n.extend(n.centralF,{pdf:function(r,e,o){var u,i,a;return 0>r?void 0:2>=e?1===e&&1===o?1/0:2===e&&1===o?1:t.sqrt(t.pow(e*r,e)*t.pow(o,o)/t.pow(e*r+o,e+o))/(r*n.betafn(e/2,o/2)):(u=e*r/(o+r*e),i=o/(o+r*e),a=e*i/2,a*n.binomial.pdf((e-2)/2,(e+o-2)/2,u))},cdf:function(t,r,e){return n.ibeta(r*t/(r*t+e),r/2,e/2)},inv:function(t,r,e){return e/(r*(1/n.ibetainv(t,r/2,e/2)-1))},mean:function(n,t){return t>2?t/(t-2):void 0},mode:function(n,t){return n>2?t*(n-2)/(n*(t+2)):void 0},sample:function(t,r){var e=2*n.randg(t/2),o=2*n.randg(r/2);return e/t/(o/r)},variance:function(n,t){return 4>=t?void 0:2*t*t*(n+t-2)/(n*(t-2)*(t-2)*(t-4))}}),n.extend(n.cauchy,{pdf:function(n,r,e){return e/(t.pow(n-r,2)+t.pow(e,2))/t.PI},cdf:function(n,r,e){return t.atan((n-r)/e)/t.PI+.5},inv:function(n,r,e){return r+e*t.tan(t.PI*(n-.5))},median:function(n,t){return n},mode:function(n,t){return n},sample:function(r,e){return n.randn()*t.sqrt(1/(2*n.randg(.5)))*e+r}}),n.extend(n.chisquare,{pdf:function(r,e){return 0===r?0:t.exp((e/2-1)*t.log(r)-r/2-e/2*t.log(2)-n.gammaln(e/2))},cdf:function(t,r){return n.lowRegGamma(r/2,t/2)},inv:function(t,r){return 2*n.gammapinv(t,.5*r)},mean:function(n){return n},median:function(n){return n*t.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(t){return 2*n.randg(t/2)},variance:function(n){return 2*n}}),n.extend(n.exponential,{pdf:function(n,r){return 0>n?0:r*t.exp(-r*n)},cdf:function(n,r){return 0>n?0:1-t.exp(-r*n)},inv:function(n,r){return-t.log(1-n)/r},mean:function(n){return 1/n},median:function(n){return 1/n*t.log(2)},mode:function(n){return 0},sample:function(n){return-1/n*t.log(t.random())},variance:function(n){return t.pow(n,-2)}}),n.extend(n.gamma,{pdf:function(r,e,o){return t.exp((e-1)*t.log(r)-r/o-n.gammaln(e)-e*t.log(o))},cdf:function(t,r,e){return n.lowRegGamma(r,t/e)},inv:function(t,r,e){return n.gammapinv(t,r)*e},mean:function(n,t){return n*t},mode:function(n,t){return n>1?(n-1)*t:void 0},sample:function(t,r){return n.randg(t)*r},variance:function(n,t){return n*t*t}}),n.extend(n.invgamma,{pdf:function(r,e,o){return t.exp(-(e+1)*t.log(r)-o/r-n.gammaln(e)+e*t.log(o))},cdf:function(t,r,e){return 1-n.lowRegGamma(r,e/t)},inv:function(t,r,e){return e/n.gammapinv(1-t,r)},mean:function(n,t){return n>1?t/(n-1):void 0},mode:function(n,t){return t/(n+1)},sample:function(t,r){return r/n.randg(t)},variance:function(n,t){return 2>=n?void 0:t*t/((n-1)*(n-1)*(n-2))}}),n.extend(n.kumaraswamy,{pdf:function(n,r,e){return t.exp(t.log(r)+t.log(e)+(r-1)*t.log(n)+(e-1)*t.log(1-t.pow(n,r)))},cdf:function(n,r,e){return 1-t.pow(1-t.pow(n,r),e)},mean:function(t,r){return r*n.gammafn(1+1/t)*n.gammafn(r)/n.gammafn(1+1/t+r)},median:function(n,r){return t.pow(1-t.pow(2,-1/r),1/n)},mode:function(n,r){return n>=1&&r>=1&&1!==n&&1!==r?t.pow((n-1)/(n*r-1),1/n):void 0},variance:function(n,t){throw new Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(n,r,e){return t.exp(-t.log(n)-.5*t.log(2*t.PI)-t.log(e)-t.pow(t.log(n)-r,2)/(2*e*e))},cdf:function(r,e,o){return.5+.5*n.erf((t.log(r)-e)/t.sqrt(2*o*o))},inv:function(r,e,o){return t.exp(-1.4142135623730951*o*n.erfcinv(2*r)+e)},mean:function(n,r){return t.exp(n+r*r/2)},median:function(n,r){return t.exp(n)},mode:function(n,r){return t.exp(n-r*r)},sample:function(r,e){return t.exp(n.randn()*e+r)},variance:function(n,r){return(t.exp(r*r)-1)*t.exp(2*n+r*r)}}),n.extend(n.noncentralt,{pdf:function(r,e,o){var u=1e-14;return t.abs(o)<u?n.studentt.pdf(r,e):t.abs(r)<u?t.exp(n.gammaln((e+1)/2)-o*o/2-.5*t.log(t.PI*e)-n.gammaln(e/2)):e/r*(n.noncentralt.cdf(r*t.sqrt(1+2/e),e+2,o)-n.noncentralt.cdf(r,e,o))},cdf:function(r,e,o){var u=1e-14,i=200;if(t.abs(o)<u)return n.studentt.cdf(r,e);var a=!1;0>r&&(a=!0,o=-o);for(var f=n.normal.cdf(-o,0,1),c=u+1,l=c,s=r*r/(r*r+e),m=0,p=t.exp(-o*o/2),g=t.exp(-o*o/2-.5*t.log(2)-n.gammaln(1.5))*o;i>m||l>u||c>u;)l=c,m>0&&(p*=o*o/(2*m),g*=o*o/(2*(m+.5))),c=p*n.beta.cdf(s,m+.5,e/2)+g*n.beta.cdf(s,m+1,e/2),f+=.5*c,m++;return a?1-f:f}}),n.extend(n.normal,{pdf:function(n,r,e){return t.exp(-.5*t.log(2*t.PI)-t.log(e)-t.pow(n-r,2)/(2*e*e))},cdf:function(r,e,o){return.5*(1+n.erf((r-e)/t.sqrt(2*o*o)))},inv:function(t,r,e){return-1.4142135623730951*e*n.erfcinv(2*t)+r},mean:function(n,t){return n},median:function(n,t){return n},mode:function(n,t){return n},sample:function(t,r){return n.randn()*r+t},variance:function(n,t){return t*t}}),n.extend(n.pareto,{pdf:function(n,r,e){return r>n?void 0:e*t.pow(r,e)/t.pow(n,e+1)},cdf:function(n,r,e){return 1-t.pow(r/n,e)},mean:function(n,r){return 1>=r?void 0:r*t.pow(n,r)/(r-1)},median:function(n,r){return n*r*t.SQRT2},mode:function(n,t){return n},variance:function(n,r){return 2>=r?void 0:n*n*r/(t.pow(r-1,2)*(r-2))}}),n.extend(n.studentt,{pdf:function(r,e){return e=e>1e100?1e100:e,1/(t.sqrt(e)*n.betafn(.5,e/2))*t.pow(1+r*r/e,-((e+1)/2))},cdf:function(r,e){var o=e/2;return n.ibeta((r+t.sqrt(r*r+e))/(2*t.sqrt(r*r+e)),o,o)},inv:function(r,e){var o=n.ibetainv(2*t.min(r,1-r),.5*e,.5);return o=t.sqrt(e*(1-o)/o),r>.5?o:-o},mean:function(n){return n>1?0:void 0},median:function(n){return 0},mode:function(n){return 0},sample:function(r){return n.randn()*t.sqrt(r/(2*n.randg(r/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(n,r,e){return 0>n?0:e/r*t.pow(n/r,e-1)*t.exp(-t.pow(n/r,e))},cdf:function(n,r,e){return 0>n?0:1-t.exp(-t.pow(n/r,e))},inv:function(n,r,e){return r*t.pow(-t.log(1-n),1/e)},mean:function(t,r){return t*n.gammafn(1+1/r)},median:function(n,r){return n*t.pow(t.log(2),1/r)},mode:function(n,r){return 1>=r?void 0:n*t.pow((r-1)/r,1/r)},sample:function(n,r){return n*t.pow(-t.log(t.random()),1/r)},variance:function(r,e){return r*r*n.gammafn(1+2/e)-t.pow(this.mean(r,e),2)}}),n.extend(n.uniform,{pdf:function(n,t,r){return t>n||n>r?0:1/(r-t)},cdf:function(n,t,r){return t>n?0:r>n?(n-t)/(r-t):1},inv:function(n,t,r){return t+n*(r-t)},mean:function(n,t){return.5*(n+t)},median:function(t,r){return n.mean(t,r)},mode:function(n,t){throw new Error("mode is not yet implemented")},sample:function(n,r){return n/2+r/2+(r/2-n/2)*(2*t.random()-1)},variance:function(n,r){return t.pow(r-n,2)/12}}),n.extend(n.binomial,{pdf:function(r,e,o){return 0===o||1===o?e*o===r?1:0:n.combination(e,r)*t.pow(o,r)*t.pow(1-o,e-r)},cdf:function(t,r,e){var o=[],u=0;if(0>t)return 0;if(r>t){for(;t>=u;u++)o[u]=n.binomial.pdf(u,r,e);return n.sum(o)}return 1}}),n.extend(n.negbin,{pdf:function(r,e,o){return r!==r|0?!1:0>r?0:n.combination(r+e-1,e-1)*t.pow(1-o,r)*t.pow(o,e)},cdf:function(t,r,e){var o=0,u=0;if(0>t)return 0;for(;t>=u;u++)o+=n.negbin.pdf(u,r,e);return o}}),n.extend(n.hypgeom,{pdf:function(r,e,o,u){if(r!==r|0)return!1;if(0>r||o-(e-u)>r)return 0;if(r>u||r>o)return 0;if(2*o>e)return 2*u>e?n.hypgeom.pdf(e-o-u+r,e,e-o,e-u):n.hypgeom.pdf(u-r,e,e-o,u);if(2*u>e)return n.hypgeom.pdf(o-r,e,o,e-u);if(u>o)return n.hypgeom.pdf(r,e,u,o);for(var i=1,a=0,f=0;r>f;f++){for(;i>1&&u>a;)i*=1-o/(e-a),a++;i*=(u-f)*(o-f)/((f+1)*(e-o-u+f+1))}for(;u>a;a++)i*=1-o/(e-a);return t.min(1,t.max(0,i))},cdf:function(r,e,o,u){if(0>r||o-(e-u)>r)return 0;if(r>=u||r>=o)return 1;if(2*o>e)return 2*u>e?n.hypgeom.cdf(e-o-u+r,e,e-o,e-u):1-n.hypgeom.cdf(u-r-1,e,e-o,u);if(2*u>e)return 1-n.hypgeom.cdf(o-r-1,e,o,e-u);if(u>o)return n.hypgeom.cdf(r,e,u,o);for(var i=1,a=1,f=0,c=0;r>c;c++){for(;i>1&&u>f;){var l=1-o/(e-f);a*=l,i*=l,f++}a*=(u-c)*(o-c)/((c+1)*(e-o-u+c+1)),i+=a}for(;u>f;f++)i*=1-o/(e-f);return t.min(1,t.max(0,i))}}),n.extend(n.poisson,{pdf:function(r,e){return t.pow(e,r)*t.exp(-e)/n.factorial(r)},cdf:function(t,r){var e=[],o=0;if(0>t)return 0;for(;t>=o;o++)e.push(n.poisson.pdf(o,r));return n.sum(e)},mean:function(n){return n},variance:function(n){return n},sample:function(n){var r=1,e=0,o=t.exp(-n);do e++,r*=t.random();while(r>o);return e-1}}),n.extend(n.triangular,{pdf:function(n,t,r,e){return t>=r||t>e||e>r?void 0:t>n||n>r?0:e>=n?e===t?1:2*(n-t)/((r-t)*(e-t)):e===r?1:2*(r-n)/((r-t)*(r-e))},cdf:function(n,r,e,o){return r>=e||r>o||o>e?void 0:r>n?0:o>=n?t.pow(n-r,2)/((e-r)*(o-r)):1-t.pow(e-n,2)/((e-r)*(e-o))},mean:function(n,t,r){return(n+t+r)/3},median:function(n,r,e){return(n+r)/2>=e?r-t.sqrt((r-n)*(r-e))/t.sqrt(2):e>(n+r)/2?n+t.sqrt((r-n)*(e-n))/t.sqrt(2):void 0},mode:function(n,t,r){return r},sample:function(n,r,e){var o=t.random();return(e-n)/(r-n)>o?n+t.sqrt(o*(r-n)*(e-n)):r-t.sqrt((1-o)*(r-n)*(r-e))},variance:function(n,t,r){return(n*n+t*t+r*r-n*t-n*r-t*r)/18}})}(this.jStat,Math),function(n,t){var r=Array.prototype.push,e=n.utils.isArray;n.extend({add:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.map(t,function(n,t,e){return n+r[t][e]})):n.map(t,function(n){return n+r})},subtract:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.map(t,function(n,t,e){return n-r[t][e]||0})):n.map(t,function(n){return n-r})},divide:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.multiply(t,n.inv(r))):n.map(t,function(n){return n/r})},multiply:function(t,r){var o,u,i,a,f=t.length,c=t[0].length,l=n.zeros(f,i=e(r)?r[0].length:c),s=0;if(e(r)){for(;i>s;s++)for(o=0;f>o;o++){for(a=0,u=0;c>u;u++)a+=t[o][u]*r[u][s];l[o][s]=a}return 1===f&&1===s?l[0][0]:l}return n.map(t,function(n){return n*r})},dot:function(t,r){e(t[0])||(t=[t]),e(r[0])||(r=[r]);for(var o,u,i=1===t[0].length&&1!==t.length?n.transpose(t):t,a=1===r[0].length&&1!==r.length?n.transpose(r):r,f=[],c=0,l=i.length,s=i[0].length;l>c;c++){for(f[c]=[],o=0,u=0;s>u;u++)o+=i[c][u]*a[c][u];f[c]=o}return 1===f.length?f[0]:f},pow:function(r,e){return n.map(r,function(n){return t.pow(n,e)})},exp:function(r){return n.map(r,function(n){return t.exp(n)})},log:function(r){return n.map(r,function(n){return t.log(n)})},abs:function(r){return n.map(r,function(n){return t.abs(n)})},norm:function(n,r){var o=0,u=0;for(isNaN(r)&&(r=2),e(n[0])&&(n=n[0]);u<n.length;u++)o+=t.pow(t.abs(n[u]),r);return t.pow(o,1/r)},angle:function(r,e){return t.acos(n.dot(r,e)/(n.norm(r)*n.norm(e)))},aug:function(n,t){for(var e=n.slice(),o=0;o<e.length;o++)r.apply(e[o],t[o]);return e},inv:function(t){for(var r,e=t.length,o=t[0].length,u=n.identity(e,o),i=n.gauss_jordan(t,u),a=[],f=0;e>f;f++)for(a[f]=[],r=o;r<i[0].length;r++)a[f][r-o]=i[f][r];return a},det:function(n){var t,r=n.length,e=2*r,o=new Array(e),u=r-1,i=e-1,a=u-r+1,f=i,c=0,l=0;if(2===r)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;e>c;c++)o[c]=1;for(c=0;r>c;c++){for(t=0;r>t;t++)o[0>a?a+r:a]*=n[c][t],o[r>f?f+r:f]*=n[c][t],a++,f--;a=--u-r+1,f=--i}for(c=0;r>c;c++)l+=o[c];for(;e>c;c++)l-=o[c];return l},gauss_elimination:function(r,e){var o,u,i,a,f=0,c=0,l=r.length,s=r[0].length,m=1,p=0,g=[];for(r=n.aug(r,e),o=r[0].length,f=0;l>f;f++){for(u=r[f][f],c=f,a=f+1;s>a;a++)u<t.abs(r[a][f])&&(u=r[a][f],c=a);if(c!=f)for(a=0;o>a;a++)i=r[f][a],r[f][a]=r[c][a],r[c][a]=i;for(c=f+1;l>c;c++)for(m=r[c][f]/r[f][f],a=f;o>a;a++)r[c][a]=r[c][a]-m*r[f][a]}for(f=l-1;f>=0;f--){for(p=0,c=f+1;l-1>=c;c++)p+=g[c]*r[f][c];g[f]=(r[f][o-1]-p)/r[f][f]}return g},gauss_jordan:function(r,e){for(var o=n.aug(r,e),u=o.length,i=o[0].length,a=0;u>a;a++){for(var f=a,l=a+1;u>l;l++)t.abs(o[l][a])>t.abs(o[f][a])&&(f=l);var s=o[a];o[a]=o[f],o[f]=s;for(var l=a+1;u>l;l++){c=o[l][a]/o[a][a];for(var m=a;i>m;m++)o[l][m]-=o[a][m]*c}}for(var a=u-1;a>=0;a--){c=o[a][a];for(var l=0;a>l;l++)for(var m=i-1;m>a-1;m--)o[l][m]-=o[a][m]*o[l][a]/c;o[a][a]/=c;for(var m=u;i>m;m++)o[a][m]/=c}return o},lu:function(n,t){throw new Error("lu not yet implemented")},cholesky:function(n,t){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(r,e,o,u){for(var i,a,f,c,l=0,s=0,m=r.length,p=[],g=[],d=[];m>l;l++)for(p[l]=[],g[l]=[],d[l]=[],s=0;m>s;s++)l>s?(p[l][s]=r[l][s],g[l][s]=d[l][s]=0):s>l?(g[l][s]=r[l][s],p[l][s]=d[l][s]=0):(d[l][s]=r[l][s],p[l][s]=g[l][s]=0);for(f=n.multiply(n.multiply(n.inv(d),n.add(p,g)),-1),a=n.multiply(n.inv(d),e),i=o,c=n.add(n.multiply(f,o),a),l=2;t.abs(n.norm(n.subtract(c,i)))>u;)i=c,c=n.add(n.multiply(f,i),a),l++;return c},gauss_seidel:function(r,e,o,u){for(var i,a,f,c,l,s=0,m=r.length,p=[],g=[],d=[];m>s;s++)for(p[s]=[],g[s]=[],d[s]=[],i=0;m>i;i++)s>i?(p[s][i]=r[s][i],g[s][i]=d[s][i]=0):i>s?(g[s][i]=r[s][i],p[s][i]=d[s][i]=0):(d[s][i]=r[s][i],p[s][i]=g[s][i]=0);for(c=n.multiply(n.multiply(n.inv(n.add(d,p)),g),-1),f=n.multiply(n.inv(n.add(d,p)),e),a=o,l=n.add(n.multiply(c,o),f),s=2;t.abs(n.norm(n.subtract(l,a)))>u;)a=l,l=n.add(n.multiply(c,a),f),s+=1;return l},SOR:function(r,e,o,u,i){for(var a,f,c,l,s,m=0,p=r.length,g=[],d=[],h=[];p>m;m++)for(g[m]=[],d[m]=[],h[m]=[],a=0;p>a;a++)m>a?(g[m][a]=r[m][a],d[m][a]=h[m][a]=0):a>m?(d[m][a]=r[m][a],g[m][a]=h[m][a]=0):(h[m][a]=r[m][a],g[m][a]=d[m][a]=0);for(l=n.multiply(n.inv(n.add(h,n.multiply(g,i))),n.subtract(n.multiply(h,1-i),n.multiply(d,i))),c=n.multiply(n.multiply(n.inv(n.add(h,n.multiply(g,i))),e),i),f=o,s=n.add(n.multiply(l,o),c),m=2;t.abs(n.norm(n.subtract(s,f)))>u;)f=s,s=n.add(n.multiply(l,f),c),m++;return s},householder:function(r){for(var e,o,u,i,a,f=r.length,c=r[0].length,l=0,s=[],m=[];f-1>l;l++){for(e=0,i=l+1;c>i;i++)e+=r[i][l]*r[i][l];for(a=r[l+1][l]>0?-1:1,e=a*t.sqrt(e),o=t.sqrt((e*e-r[l+1][l]*e)/2),s=n.zeros(f,1),s[l+1][0]=(r[l+1][l]-e)/(2*o),u=l+2;f>u;u++)s[u][0]=r[u][l]/(2*o);m=n.subtract(n.identity(f,c),n.multiply(n.multiply(s,n.transpose(s)),2)),r=n.multiply(m,n.multiply(r,m))}return r},QR:function(r,e){for(var o,u,i,a,f,c,l=r.length,s=r[0].length,m=0,p=[],g=[],d=[];l-1>m;m++){for(u=0,o=m+1;s>o;o++)u+=r[o][m]*r[o][m];for(f=r[m+1][m]>0?-1:1,u=f*t.sqrt(u),i=t.sqrt((u*u-r[m+1][m]*u)/2),p=n.zeros(l,1),p[m+1][0]=(r[m+1][m]-u)/(2*i),a=m+2;l>a;a++)p[a][0]=r[a][m]/(2*i);g=n.subtract(n.identity(l,s),n.multiply(n.multiply(p,n.transpose(p)),2)),r=n.multiply(g,r),e=n.multiply(g,e)}for(m=l-1;m>=0;m--){for(c=0,o=m+1;s-1>=o;o++)c=d[o]*r[m][o];d[m]=e[m][0]/r[m][m]}return d},jacobi:function(r){for(var e,o,u,i,a,f,c,l,s=1,m=0,p=r.length,g=n.identity(p,p),d=[];1===s;){for(m++,f=r[0][1],i=0,a=1,o=0;p>o;o++)for(u=0;p>u;u++)o!=u&&f<t.abs(r[o][u])&&(f=t.abs(r[o][u]),i=o,a=u);for(c=r[i][i]===r[a][a]?r[i][a]>0?t.PI/4:-t.PI/4:t.atan(2*r[i][a]/(r[i][i]-r[a][a]))/2,l=n.identity(p,p),l[i][i]=t.cos(c),l[i][a]=-t.sin(c),l[a][i]=t.sin(c),l[a][a]=t.cos(c),g=n.multiply(g,l),e=n.multiply(n.multiply(n.inv(l),r),l),r=e,s=0,o=1;p>o;o++)for(u=1;p>u;u++)o!=u&&t.abs(r[o][u])>.001&&(s=1)}for(o=0;p>o;o++)d.push(r[o][o]);return[g,d]},rungekutta:function(n,t,r,e,o,u){var i,a,f,c,l;if(2===u)for(;r>=e;)i=t*n(e,o),a=t*n(e+t,o+i),f=o+(i+a)/2,o=f,e+=t;if(4===u)for(;r>=e;)i=t*n(e,o),a=t*n(e+t/2,o+i/2),c=t*n(e+t/2,o+a/2),l=t*n(e+t,o+c),f=o+(i+2*a+2*c+l)/6,o=f,e+=t;return o},romberg:function(n,r,e,o){for(var u,i,a,f,c,l=0,s=(e-r)/2,m=[],p=[],g=[];o/2>l;){for(c=n(r),a=r,f=0;e>=a;a+=s,f++)m[f]=a;for(u=m.length,a=1;u-1>a;a++)c+=(a%2!==0?4:2)*n(m[a]);c=s/3*(c+n(e)),g[l]=c,s/=2,l++}for(i=g.length,u=1;1!==i;){for(a=0;i-1>a;a++)p[a]=(t.pow(4,u)*g[a+1]-g[a])/(t.pow(4,u)-1);i=p.length,g=p,p=[],u++}return g},richardson:function(n,r,e,o){function u(n,t){for(var r,e=0,o=n.length;o>e;e++)n[e]===t&&(r=e);return r}for(var i,a,f,c,l,s=(n.length,t.abs(e-n[u(n,e)+1])),m=0,p=[],g=[];o>=s;)i=u(n,e+o),a=u(n,e),p[m]=(r[i]-2*r[a]+r[2*a-i])/(o*o),o/=2,m++;for(c=p.length,f=1;1!=c;){for(l=0;c-1>l;l++)g[l]=(t.pow(4,f)*p[l+1]-p[l])/(t.pow(4,f)-1);c=g.length,p=g,g=[],f++}return p},simpson:function(n,t,r,e){for(var o,u=(r-t)/e,i=n(t),a=[],f=t,c=0,l=1;r>=f;f+=u,c++)a[c]=f;for(o=a.length;o-1>l;l++)i+=(l%2!==0?4:2)*n(a[l]);return u/3*(i+n(r))},hermite:function(n,t,r,e){for(var o,u=n.length,i=0,a=0,f=[],c=[],l=[],s=[];u>a;a++){for(f[a]=1,o=0;u>o;o++)a!=o&&(f[a]*=(e-n[o])/(n[a]-n[o]));for(c[a]=0,o=0;u>o;o++)a!=o&&(c[a]+=1/(n[a]-n[o]));l[a]=(1-2*(e-n[a])*c[a])*f[a]*f[a],s[a]=(e-n[a])*f[a]*f[a],i+=l[a]*t[a]+s[a]*r[a]}return i},lagrange:function(n,t,r){for(var e,o,u=0,i=0,a=n.length;a>i;i++){for(o=t[i],e=0;a>e;e++)i!=e&&(o*=(r-n[e])/(n[i]-n[e]));u+=o}return u},cubic_spline:function(t,r,e){for(var o,u=t.length,i=0,a=[],f=[],c=[],l=[],s=[],m=[],p=[];u-1>i;i++)s[i]=t[i+1]-t[i];for(c[0]=0,i=1;u-1>i;i++)c[i]=3/s[i]*(r[i+1]-r[i])-3/s[i-1]*(r[i]-r[i-1]);for(i=1;u-1>i;i++)a[i]=[],f[i]=[],a[i][i-1]=s[i-1],a[i][i]=2*(s[i-1]+s[i]),a[i][i+1]=s[i],f[i][0]=c[i];for(l=n.multiply(n.inv(a),f),o=0;u-1>o;o++)m[o]=(r[o+1]-r[o])/s[o]-s[o]*(l[o+1][0]+2*l[o][0])/3,p[o]=(l[o+1][0]-l[o][0])/(3*s[o]);for(o=0;u>o&&!(t[o]>e);o++);return o-=1,r[o]+(e-t[o])*m[o]+n.sq(e-t[o])*l[o]+(e-t[o])*n.sq(e-t[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var r,e,o=t.length,u=t[0].length,i=0,a=[],f=[],c=[],l=[],s=[],m=[],p=[],g=[],d=[],h=[];for(i=0;o>i;i++)a[i]=n.sum(t[i])/u;for(i=0;u>i;i++)for(p[i]=[],r=0;o>r;r++)p[i][r]=t[r][i]-a[r];for(p=n.transpose(p),i=0;o>i;i++)for(g[i]=[],r=0;o>r;r++)g[i][r]=n.dot([p[i]],[p[r]])/(u-1);
for(c=n.jacobi(g),d=c[0],f=c[1],h=n.transpose(d),i=0;i<f.length;i++)for(r=i;r<f.length;r++)f[i]<f[r]&&(e=f[i],f[i]=f[r],f[r]=e,l=h[i],h[i]=h[r],h[r]=l);for(m=n.transpose(p),i=0;o>i;i++)for(s[i]=[],r=0;r<m.length;r++)s[i][r]=n.dot([h[i]],[m[r]]);return[t,f,h,s]}}),function(t){for(var r=0;r<t.length;r++)(function(t){n.fn[t]=function(r,e){var o=this;return e?(setTimeout(function(){e.call(o,n.fn[t].call(o,r))},15),this):"number"==typeof n[t](this,r)?n[t](this,r):n(n[t](this,r))}})(t[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(this.jStat,Math),function(n,t){var r=[].slice,e=n.utils.isNumber,o=n.utils.isArray;n.extend({zscore:function(){var t=r.call(arguments);return e(t[1])?(t[0]-t[1])/t[2]:(t[0]-n.mean(t[1]))/n.stdev(t[1],t[2])},ztest:function(){var e,u=r.call(arguments);return o(u[1])?(e=n.zscore(u[0],u[1],u[3]),1===u[2]?n.normal.cdf(-t.abs(e),0,1):2*n.normal.cdf(-t.abs(e),0,1)):u.length>2?(e=n.zscore(u[0],u[1],u[2]),1===u[3]?n.normal.cdf(-t.abs(e),0,1):2*n.normal.cdf(-t.abs(e),0,1)):(e=u[0],1===u[1]?n.normal.cdf(-t.abs(e),0,1):2*n.normal.cdf(-t.abs(e),0,1))}}),n.extend(n.fn,{zscore:function(n,t){return(n-this.mean())/this.stdev(t)},ztest:function(r,e,o){var u=t.abs(this.zscore(r,o));return 1===e?n.normal.cdf(-u,0,1):2*n.normal.cdf(-u,0,1)}}),n.extend({tscore:function(){var e=r.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/t.sqrt(e[3])):(e[0]-n.mean(e[1]))/(n.stdev(e[1],!0)/t.sqrt(e[1].length))},ttest:function(){var o,u=r.call(arguments);return 5===u.length?(o=t.abs(n.tscore(u[0],u[1],u[2],u[3])),1===u[4]?n.studentt.cdf(-o,u[3]-1):2*n.studentt.cdf(-o,u[3]-1)):e(u[1])?(o=t.abs(u[0]),1==u[2]?n.studentt.cdf(-o,u[1]-1):2*n.studentt.cdf(-o,u[1]-1)):(o=t.abs(n.tscore(u[0],u[1])),1==u[2]?n.studentt.cdf(-o,u[1].length-1):2*n.studentt.cdf(-o,u[1].length-1))}}),n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(r,e){return 1===e?1-n.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):2*n.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)}}),n.extend({anovafscore:function(){var e,o,u,i,a,f,c,l,s=r.call(arguments);if(1===s.length){for(a=new Array(s[0].length),c=0;c<s[0].length;c++)a[c]=s[0][c];s=a}if(2===s.length)return n.variance(s[0])/n.variance(s[1]);for(o=new Array,c=0;c<s.length;c++)o=o.concat(s[c]);for(u=n.mean(o),e=0,c=0;c<s.length;c++)e+=s[c].length*t.pow(n.mean(s[c])-u,2);for(e/=s.length-1,f=0,c=0;c<s.length;c++)for(i=n.mean(s[c]),l=0;l<s[c].length;l++)f+=t.pow(s[c][l]-i,2);return f/=o.length-s.length,e/f},anovaftest:function(){var t,o,u,i,a=r.call(arguments);if(e(a[0]))return 1-n.centralF.cdf(a[0],a[1],a[2]);for(anovafscore=n.anovafscore(a),t=a.length-1,u=0,i=0;i<a.length;i++)u+=a[i].length;return o=u-t-1,1-n.centralF.cdf(anovafscore,t,o)},ftest:function(t,r,e){return 1-n.centralF.cdf(t,r,e)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var t,r=0;for(t=0;t<this.length;t++)r+=this[t].length;return n.ftest(this.anovafscore(),this.length-1,r-this.length)}}),n.extend({normalci:function(){var e,o=r.call(arguments),u=new Array(2);return e=4===o.length?t.abs(n.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/t.sqrt(o[2].length)),u[0]=o[0]-e,u[1]=o[0]+e,u},tci:function(){var e,o=r.call(arguments),u=new Array(2);return e=4===o.length?t.abs(n.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(n.studentt.inv(o[1]/2,o[2].length-1)*n.stdev(o[2],!0)/t.sqrt(o[2].length)),u[0]=o[0]-e,u[1]=o[0]+e,u},significant:function(n,t){return t>n}}),n.extend(n.fn,{normalci:function(t,r){return n.normalci(t,r,this.toArray())},tci:function(t,r){return n.tci(t,r,this.toArray())}})}(this.jStat,Math);